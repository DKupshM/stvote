{"version":3,"sources":["firebase.js","Components/NavBar/NavBar.js","Components/Home.js","Components/Hooks/useInterval.js","Data_Models/Candidate.js","Components/ElectionPage/Race/ProgressBar.js","Components/ElectionPage/Race/CandidatePosition.js","Components/ElectionPage/Race/CandidateList.js","Components/ElectionPage/Models/FirstChoicePie.js","Components/ElectionPage/Models/ElectedCandidatesPie.js","Components/ElectionPage/Models/CandidatesRanked.js","Components/ElectionPage/Models/PartyPercentage.js","Components/ElectionPage/Models/EventualWinner.js","Components/ElectionPage/Models/VoteOverTime.js","Components/ElectionPage/Models/VoteOverTimeBump.js","Components/ElectionPage/Models/RoundCandidateBump.js","Data_Models/Round.js","Data_Models/Race.js","Data_Models/Voter.js","Data_Models/Ballot.js","Data_Models/Party.js","Components/ElectionPage/Models/Sankey.js","Components/ElectionPage/Models/ElectionBar.js","Components/ElectionPage/ElectionPage.js","Components/FourZeroFour.js","Components/AddToDatabase.js","App.js","serviceWorker.js","index.js"],"names":["firebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","NavBar","props","useState","activeKey","setActiveKey","handleSelect","eventKey","Number","isInteger","Navbar","collapseOnSelect","expand","bg","variant","Brand","href","onClick","Toggle","aria-controls","Collapse","id","Nav","className","onSelect","Link","Home","CreateSelectButton","election_title","filename","years","yearButtons","map","item","index","Button","key","year","console","log","OnClick","ButtonGroup","vertical","size","style","padding","disabled","asuc","asucsb","asucsd","asucd","asucsc","asucla","display","alignItems","justifyContent","flexWrap","useInterval","callback","delay","savedCallback","useRef","useEffect","current","setInterval","clearInterval","Candidate","candidate_id","candidate_name","candidate_party","this","CandidateState","ProgressBar","bgcolor","completed","fillerStyles","height","width","backgroundColor","borderRadius","textAlign","color","fontWeight","Math","floor","CandidatePosition","get_status_color","status","position","isNaN","candidate","party_color","party_name","score","margin","quota","min","CandidateList","candidate_list","candidates","sort","x","y","scope","FirstChoicePie","find_party_by_name","name","i","parties","length","get_ranked_choices","race","party","ranked_choices","ballots","choices","data","totalAmount","push","top","right","bottom","left","pixelRatio","padAngle","cornerRadius","colors","bar","borderColor","from","modifiers","radialLabelsSkipAngle","radialLabelsTextXOffset","radialLabelsTextColor","radialLabelsLinkOffset","radialLabelsLinkDiagonalLength","radialLabelsLinkHorizontalLength","radialLabelsLinkStrokeWidth","radialLabelsLinkColor","sliceLabel","round","value","slicesLabelsSkipAngle","slicesLabelsTextColor","animate","motionStiffness","motionDamping","PartyPercentage","find_candidate_by_id","elected","CandidatesRanked","ballot","num_ranked","maxChoices","max","keys","data_to_add","indexBy","innerPadding","minValue","maxValue","groupMode","layout","reverse","colorBy","borderWidth","axisTop","axisRight","axisBottom","tickSize","tickPadding","tickRotation","legend","legendPosition","legendOffset","axisLeft","enableGridX","enableGridY","enableLabel","labelSkipWidth","labelSkipHeight","labelTextColor","isInteractive","maxchoices","datapoints","xScale","type","yScale","stacked","orient","enablePoints","enableArea","areaOpacity","useMesh","eventualElected","electeddatapoints","notelecteddatapoints","VoteOverTime","String","choices_over_time","first_scores","score_chart","xFormat","yFormat","tickValues","lineWidth","VoteOverTimeBump","indexOfMax","arr","maxIndex","increment","candidate_positions","scores","splice","datapoint","scheme","activeLineWidth","inactiveLineWidth","inactiveOpacity","pointSize","activePointSize","inactivePointSize","format","RoundCandidateBump","rounds","elected_candidates","includes","round_number","eliminated_candidates","transferring","transfered","active_candidates","candidate_score","indexOf","pointColor","theme","pointBorderWidth","activePointBorderWidth","pointBorderColor","Round","add_ballot","state","RoundState","COMPLETE","Error","undefined","ballot_id","find_next_active_candidate","candidate_ballots","candidate_scores","add_candidate","start_inactive_candidates","start_active_candidates","set_elected_candidate","filter","ballotsToTransfer","set_eliminate_candidate","candidate_ballot","complete","isCandidateElected","candidate_real_scores","RUNNING","exhausted","rankings","Race","race_id","race_name","seats","running","num_candidates","RaceState","ADDING","currentScores","candidateTable","start_tabulation","TABULATING","run_race_step","elect_candidate","currentRound","Object","surplus","transfer_value","ballots_to_apply","transfer_candidate","shift","candidate_ballot_rankings","first_round_score","activeCandidates","roundElected","maxElected","roundTransfer","complete_round","previousRound","add_round","begin_race","transfer_voters","Voter","voter_id","participating_races","races","participating_in_race","get_ballot_for_race","Ballot","Party","isValidColor","s","Option","Sankey","active_candidate","prev_round","nodes","links","link","source","target","transfer_candidates_ballot","next_candidate","transfer_candidate_id","GenerateData","align","nodeOpacity","nodeThickness","nodeInnerPadding","nodeSpacing","nodeBorderWidth","nodeBorderColor","linkOpacity","linkHoverOpacity","linkHoverOthersOpacity","enableLinkGradient","enableLabels","label","node","labelPosition","labelOrientation","labelPadding","ElectionBar","get_round_data","round_data","get_candidate_position","candidate_table","get_candidate_by_position","final_candidate_score","setRound","data_active_candidates","round_active_candidates","chart_data","transferred","step","onChange","changeEvent","max_score","get_max_score","ElectionPage","find_race_by_id","find_race_by_name","election_configuration","setElectionConfiguration","candidate_data","setCandidateData","party_data","setPartyData","ballot_data","setBallotData","isLoading","setIsLoading","partiesLoaded","setPartiesLoaded","racesLoaded","setRacesLoaded","candidatesLoaded","setCandidatesLoaded","votersLoaded","setVotersLoaded","setParties","setRaces","voters","setVoters","activeRace","setActiveRace","speed","setSpeed","refresh","setRefresh","isRunning","setIsRunning","page","setPage","model","setModel","a","parties_data","electionId","match","params","yearId","databaseString","database","ref","once","snapshot","exists","child","val","loadData","partiesToAdd","loadParties","racesToAdd","race_position","race_max_winners","loadRaces","number","loadCandidates","voter","uuid","candidateOrder","loadVoters","pageButtonStyle","pageButtons","raceTitle","font","dropdownItems","Dropdown","Item","as","DropdownButton","title","boxShadow","chartStyle","alignSelf","ElectedCandidatesPie","EventualWinner","modelButtons","minHeight","FourZeroFour","Component","AddToDatabase","event","preventDefault","reader","FileReader","onload","JSON","parse","result","files","readAsText","electionName","setElectionName","setYear","Form","onSubmit","checkStrings","str","alert","set","Group","Control","placeholder","justifyItems","File","accept","NavBarWithRouter","withRouter","App","basename","exact","path","to","component","render","Boolean","window","location","hostname","ReactDOM","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.e58234a7.chunk.js","sourcesContent":["import firebase from 'firebase';\nconst config = {\n    apiKey: \"AIzaSyCFNJfMcHbdoAKVVF88d-9POsUgk-C7NKk\",\n    authDomain: \"stvote-b967b.firebaseapp.com\",\n    databaseURL: \"https://stvote-b967b.firebaseio.com\",\n    projectId: \"stvote-b967b\",\n    storageBucket: \"stvote-b967b.appspot.com\",\n    messagingSenderId: \"487837721842\",\n    appId: \"1:487837721842:web:95c0dc83a5eeb46b995c6b\"\n}\n\n// Initialize Firebase\nfirebase.initializeApp(config);\n\nexport default firebase;","import React, { useState } from 'react';\nimport Nav from 'react-bootstrap/Nav'\nimport Navbar from 'react-bootstrap/Navbar'\n\nfunction NavBar(props) {\n\n    const [activeKey, setActiveKey] = useState(1);\n\n    const handleSelect = (eventKey) => {\n        if (Number.isInteger(eventKey))\n            setActiveKey(eventKey);\n        else\n            setActiveKey(0);\n    };\n\n\n    return (\n        <Navbar collapseOnSelect expand=\"lg\" bg=\"dark\" variant=\"dark\">\n            <Navbar.Brand href=\"/stvote/home\" onClick={handleSelect}>STVote</Navbar.Brand>\n            <Navbar.Toggle aria-controls=\"responsive-navbar-nav\" />\n            <Navbar.Collapse id=\"responsive-navbar-nav\">\n                <Nav activeKey={activeKey} className=\"mr-auto\" onSelect={handleSelect}>\n                    <Nav.Link eventKey={1} href=\"/stvote/home\">Home</Nav.Link>\n                    <Nav.Link eventKey={1} href=\"/stvote/election\">Election</Nav.Link>\n                </Nav>\n            </Navbar.Collapse>\n        </Navbar>\n    );\n}\n\nexport default NavBar;","import React from 'react';\nimport ButtonGroup from 'react-bootstrap/ButtonGroup'\nimport Button from 'react-bootstrap/Button'\n\nfunction Home(props) {\n    const OnClick = (election_title, year) => {\n\n        console.log(\"Clicked\", election_title, year);\n    }\n    const CreateSelectButton = (election_title, filename, years) => {\n        let yearButtons = years.map((item, index) => (\n            <Button key={index} href={\"/stvote/election/\" + filename + \"/\" + item} onClick={() => OnClick(election_title, item)}>{item}</Button>\n        ));\n\n        return (\n            <ButtonGroup vertical size=\"lg\" style={{ padding: '2%' }}>\n                <Button variant=\"dark\" disabled={true}>{election_title}</Button>\n                {yearButtons}\n            </ButtonGroup>\n        );\n    }\n\n    let asuc = CreateSelectButton('ASUC Berkeley', \"uc_berkeley\", [2015, 2016, 2017, 2018, 2019, 2020]);\n    let asucsb = CreateSelectButton('ASUC Santa Barbara', \"uc_berkeley\", [2018, 2019, 2020]);\n    let asucsd = CreateSelectButton('AS UC San Diego', \"uc_berkeley\", [2018, 2019, 2020]);\n    let asucd = CreateSelectButton('AS UC Davis', \"uc_berkeley\", [2018, 2019, 2020]);\n    let asucsc = CreateSelectButton('AS UC Santa Cruz', \"uc_berkeley\", [2018, 2019, 2020]);\n    let asucla = CreateSelectButton('AS UC Los Angeles', \"uc_berkeley\", [2018, 2019, 2020]);\n\n    return (\n        <div className=\"text-center\">\n            <h1> STVote Elections </h1>\n            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-evenly', flexWrap: 'wrap' }}>\n                {asuc}\n                {asucsb}\n                {asucsd}\n                {asucd}\n                {asucsc}\n                {asucla}\n            </div>\n        </div >\n    );\n}\n\nexport default Home;\n","import { useEffect, useRef } from 'react';\n\nfunction useInterval(callback, delay) {\n  const savedCallback = useRef();\n\n  // Remember the latest callback.\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  // Set up the interval.\n  useEffect(() => {\n    function tick() {\n      savedCallback.current();\n    }\n    if (delay !== null) {\n      let id = setInterval(tick, delay);\n      return () => clearInterval(id);\n    }\n  }, [delay]);\n}\n\nexport default useInterval;","\nexport class Candidate {\n    constructor(candidate_id, candidate_name, candidate_party) {\n        this.candidate_id = candidate_id;\n        this.candidate_name = candidate_name;\n        this.candidate_party = candidate_party;\n    }\n}\n\nexport const CandidateState = {\n    ELECTED: \"ELECTED\",\n    RUNNING: \"RUNNING\",\n    TRANSFERRING: \"TRANSFERRING\",\n    TRANSFERED: \"TRANSFERED\",\n    EXCUSED: \"EXCUSED\",\n};","import React from 'react';\n\nconst ProgressBar = (props) => {\n    const { bgcolor, completed } = props;\n\n    const containerStyles = {\n        height: '48px',\n        width: '100%',\n        backgroundColor: \"#fffbf5\",\n    }\n\n    const fillerStyles = {\n        height: '100%',\n        width: `${completed}%`,\n        backgroundColor: bgcolor,\n        borderRadius: 'inherit',\n        textAlign: 'right'\n    }\n\n    const labelStyles = {\n        padding: 5,\n        color: 'black',\n        fontWeight: 'bold'\n    }\n\n    return (\n        <div style={containerStyles}>\n            <div style={fillerStyles}>\n                <span style={labelStyles}>{`${Math.floor(completed)}%`}</span>\n            </div>\n        </div>\n    );\n};\n\nexport default ProgressBar;","import React from 'react';\nimport { CandidateState } from '../../../Data_Models/Candidate';\nimport ProgressBar from './ProgressBar';\nimport '../ElectionPage.css'\n\nfunction CandidatePosition(props) {\n    const get_status_color = () => {\n        if (props.status === CandidateState.ELECTED)\n            return \"#01A039\";\n        else if (props.status === CandidateState.RUNNING)\n            return \"#0095E0\";\n        else if (props.status === CandidateState.TRANSFERRING)\n            return \"#E07A00\";\n        else if (props.status === CandidateState.TRANSFERED)\n            return \"#FF0000\";\n    }\n\n    const get_status_text = () => {\n        if (props.status === CandidateState.ELECTED)\n            return \"ELECTED\";\n        else if (props.status === CandidateState.RUNNING)\n            return \"RUNNING\";\n        else if (props.status === CandidateState.TRANSFERRING)\n            return \"TRANSFERRING\";\n        else if (props.status === CandidateState.TRANSFERED)\n            return \"TRANSFERED\";\n    }\n\n    const get_position = () => {\n        if (Number.isInteger(props.position) && !Number.isNaN(props.position))\n            return props.position + 1;\n        return 0;\n    }\n\n    const get_percentage = () => {\n        if (props.quota === 0)\n            return 0;\n        return Math.min(100, (props.score / props.quota) * 100);\n    }\n\n    return (\n        <tr>\n            <td className=\"basic-row\" width=\"1\"> {get_position()} </td>\n            <td className=\"basic-row\" width=\"1\"> {props.candidate.candidate_name} </td>\n            <td className=\"basic-row\" width=\"1\" style={{ backgroundColor: props.candidate.candidate_party.party_color }}> {props.candidate.candidate_party.party_name} </td >\n            <td className=\"basic-row\" width=\"150\" style={{ backgroundColor: get_status_color() }}> {get_status_text()} </td >\n            <td className=\"basic-row\" width=\"100\" style={{ backgroundColor: get_status_color() }}> {Math.floor(props.score)} </td >\n            <td style={{ padding: \"0 0 0 0\", margin: \"0 0 0 0\" }}>\n                <div style={{ display: 'inline-block', width: '100%', height: '100%' }}>\n                    <ProgressBar bgcolor={get_status_color()} completed={get_percentage()} />\n                </div>\n            </td >\n        </tr >\n    );\n}\n\nexport default CandidatePosition;\n","import React from 'react';\nimport CandidatePosition from './CandidatePosition';\nimport '../ElectionPage.css'\n\nfunction CandidateList(props) {\n\n    let sortedCandidates = props.candidates().sort((x, y) => {\n        if (x.position > y.position) {\n            return 1;\n        } else if (y.position > x.position) {\n            return -1;\n        }\n        return 0;\n    });\n\n\n    let candidate_list = sortedCandidates.map((item, index) => (\n        <CandidatePosition key={index} candidate={item.candidate} status={item.status}\n            score={item.score} position={item.position} quota={item.quota} />\n    ));\n\n    return (\n        <div className=\"table-responsive\">\n            <table className=\"table table-bordered\" >\n                <thead className=\"thead-dark\">\n                    <tr>\n                        <th className=\"title-row\" scope=\"col\" width=\"1\" >#</th>\n                        <th className=\"title-row\" scope=\"col\" width=\"1\" >Name</th>\n                        <th className=\"title-row\" scope=\"col\" width=\"1\" >Party</th>\n                        <th className=\"title-row\" scope=\"col\" width=\"1\">Status</th>\n                        <th className=\"title-row\" scope=\"col\" width=\"1\" > Score</th >\n                        <th className=\"title-row\" scope=\"col\">Quota Percentage</th>\n                    </tr >\n                </thead >\n                <tbody>\n                    {candidate_list}\n                </tbody>\n            </table >\n        </div >\n    );\n}\n\nexport default CandidateList;\n","import React from 'react';\n\nimport { ResponsivePieCanvas } from '@nivo/pie';\n\nfunction FirstChoicePie(props) {\n\n    const find_party_by_name = (name) => {\n        for (let i = 0; i < props.parties.length; i++)\n            if (props.parties[i].party_name === name)\n                return props.parties[i];\n        return null\n    };\n\n    const get_ranked_choices = (race, party) => {\n        let ranked_choices = 0;\n        for (const ballot of race.ballots) {\n            if (ballot.candidates[0].candidate_party.party_name === party.party_name)\n                ranked_choices += 1;\n        }\n        return ranked_choices;\n    }\n\n    let choices = {};\n    for (const party of props.parties) {\n        let ranked_choices = get_ranked_choices(props.race, party);\n        if (ranked_choices > 0)\n            choices[party.party_name] = get_ranked_choices(props.race, party);\n    }\n\n    let data = [];\n    let totalAmount = 0;\n\n    for (const item in choices) {\n        data.push({\n            \"id\": item,\n            \"label\": item,\n            \"value\": choices[item],\n            \"color\": find_party_by_name(item).party_color,\n        });\n        totalAmount += choices[item];\n    }\n\n    const getPercentage = bar => {\n        return Math.round((bar.value / totalAmount) * 100) + \"%\";\n    }\n\n    const getColor = bar => find_party_by_name(bar.id).party_color;\n\n    return (\n        <div style={props.style}>\n            <ResponsivePieCanvas\n                data={data}\n                margin={{ top: 40, right: 40, bottom: 40, left: 40 }}\n                pixelRatio={2}\n                padAngle={0.7}\n                cornerRadius={1}\n                colors={getColor}\n                borderColor={{ from: 'color', modifiers: [['darker', 0.6]] }}\n                radialLabelsSkipAngle={10}\n                radialLabelsTextXOffset={6}\n                radialLabelsTextColor={{ from: 'color', modifiers: [] }}\n                radialLabelsLinkOffset={0}\n                radialLabelsLinkDiagonalLength={16}\n                radialLabelsLinkHorizontalLength={24}\n                radialLabelsLinkStrokeWidth={1}\n                radialLabelsLinkColor={{ from: 'color' }}\n                sliceLabel={getPercentage}\n                slicesLabelsSkipAngle={20}\n                slicesLabelsTextColor=\"#333333\"\n                animate={true}\n                motionStiffness={90}\n                motionDamping={15}\n            />\n        </div>\n    );\n}\n\nexport default FirstChoicePie;\n","import React from 'react';\n\nimport { ResponsivePieCanvas } from '@nivo/pie';\n\nfunction PartyPercentage(props) {\n    const find_candidate_by_id = (race, id) => {\n        for (const candidate of race.candidates)\n            if (candidate.candidate_id === id)\n                return candidate;\n        return null;\n    }\n\n    const find_party_by_name = (name) => {\n        for (let i = 0; i < props.parties.length; i++)\n            if (props.parties[i].party_name === name)\n                return props.parties[i];\n        return null\n    };\n\n    const get_ranked_choices = (race, party) => {\n        let ranked_choices = 0;\n        for (const candidate in race.elected) {\n            if (find_candidate_by_id(race, candidate).candidate_party === party)\n                ranked_choices += 1;\n        }\n        return ranked_choices;\n    }\n\n    let choices = {};\n    for (const party of props.parties) {\n        let ranked_choices = get_ranked_choices(props.race, party);\n        if (ranked_choices > 0)\n            choices[party.party_name] = get_ranked_choices(props.race, party);\n    }\n\n    let data = [];\n    let totalAmount = 0;\n\n    for (const item in choices) {\n        data.push({\n            \"id\": item,\n            \"label\": item,\n            \"value\": choices[item],\n            \"color\": find_party_by_name(item).party_color,\n        });\n        totalAmount += choices[item];\n    }\n\n    const getPercentage = bar => {\n        return Math.round((bar.value / totalAmount) * 100) + \"%\";\n    }\n\n    const getColor = bar => find_party_by_name(bar.id).party_color;\n\n    return (\n        <div style={props.style}>\n            <ResponsivePieCanvas\n                data={data}\n                margin={{ top: 40, right: 40, bottom: 40, left: 40 }}\n                pixelRatio={2}\n                padAngle={0.7}\n                cornerRadius={1}\n                colors={getColor}\n                borderColor={{ from: 'color', modifiers: [['darker', 0.6]] }}\n                radialLabelsSkipAngle={10}\n                radialLabelsTextXOffset={6}\n                radialLabelsTextColor={{ from: 'color', modifiers: [] }}\n                radialLabelsLinkOffset={0}\n                radialLabelsLinkDiagonalLength={16}\n                radialLabelsLinkHorizontalLength={24}\n                radialLabelsLinkStrokeWidth={1}\n                radialLabelsLinkColor={{ from: 'color' }}\n                sliceLabel={getPercentage}\n                slicesLabelsSkipAngle={20}\n                slicesLabelsTextColor=\"#333333\"\n                animate={true}\n                motionStiffness={90}\n                motionDamping={15}\n            />\n        </div>\n    );\n}\n\nexport default PartyPercentage;\n","import React from 'react';\n\nimport { ResponsiveBarCanvas } from '@nivo/bar'\n\nfunction CandidatesRanked(props) {\n    const find_party_by_name = (name) => {\n        for (let i = 0; i < props.parties.length; i++)\n            if (props.parties[i].party_name === name)\n                return props.parties[i];\n        return null\n    };\n\n    const get_ranked_choices = (race, party) => {\n        let ballots = race.ballots;\n        let ranked_choices = {};\n        for (const ballot of ballots) {\n            if (ballot.candidates[0].candidate_party.party_name !== party.party_name)\n                continue;\n            const num_ranked = ballot.candidates.length;\n            maxChoices = Math.max(num_ranked, maxChoices);\n            if (num_ranked in ranked_choices)\n                ranked_choices[num_ranked] += 1;\n            else\n                ranked_choices[num_ranked] = 1;\n        }\n        return ranked_choices;\n    }\n\n    let maxChoices = 0;\n    let choices = {};\n    let keys = []\n    for (const party of props.parties) {\n        choices[party.party_name] = get_ranked_choices(props.race, party);\n        keys.push(party.party_name);\n    }\n\n    let data = [];\n\n    for (let i = 1; i < maxChoices + 1; i++) {\n        let data_to_add = { index: i };\n        for (const item in choices) {\n            if (i in choices[item]) {\n                data_to_add[item] = choices[item][i];\n                data_to_add[item + \"Color\"] = choices[item][i];\n            }\n        }\n        data.push(data_to_add);\n    }\n    const getColor = bar => find_party_by_name(bar.id).party_color;\n\n    return (\n        <div style={props.style}>\n            <ResponsiveBarCanvas\n                data={data}\n                keys={keys}\n                indexBy=\"index\"\n                margin={{ top: 40, right: 40, bottom: 40, left: 60 }}\n                pixelRatio={2}\n                padding={0.05}\n                innerPadding={0}\n                minValue=\"auto\"\n                maxValue=\"auto\"\n                groupMode=\"stacked\"\n                layout=\"vertical\"\n                reverse={false}\n                colors={getColor}\n                colorBy=\"id\"\n                borderWidth={0}\n                borderColor={{ from: 'color', modifiers: [['darker', 1.6]] }}\n                axisTop={null}\n                axisRight={null}\n                axisBottom={{\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 0,\n                    legend: 'Candidates Ranked',\n                    legendPosition: 'middle',\n                    legendOffset: 30\n                }}\n                axisLeft={{\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 0,\n                    legend: 'Number of Voters',\n                    legendPosition: 'middle',\n                    legendOffset: -40\n                }}\n                enableGridX={false}\n                enableGridY={true}\n                enableLabel={false}\n                labelSkipWidth={12}\n                labelSkipHeight={12}\n                labelTextColor={{ from: 'color', modifiers: [['darker', 1.6]] }}\n                isInteractive={true}\n            />\n        </div>\n    );\n}\n\nexport default CandidatesRanked;\n","import React from 'react';\n\nimport { ResponsiveLine } from '@nivo/line'\n\n\nfunction PartyPercentage(props) {\n    const find_party_by_name = (name) => {\n        for (let i = 0; i < props.parties.length; i++)\n            if (props.parties[i].party_name === name)\n                return props.parties[i];\n        return null\n    };\n\n    const get_ranked_choices = (race, party) => {\n        let ballots = race.ballots;\n        let ranked_choices = {};\n        for (const ballot of ballots) {\n            for (let i = 0; i < ballot.candidates.length; i++) {\n                maxchoices = Math.max(i, maxchoices);\n                if (ballot.candidates[i].candidate_party.party_name === party.party_name)\n                    if (i in ranked_choices)\n                        ranked_choices[i] += 1;\n                    else\n                        ranked_choices[i] = 1;\n            }\n        }\n        return ranked_choices;\n    }\n    let maxchoices = 0;\n    let choices = {};\n    for (const party of props.parties) {\n        choices[party.party_name] = get_ranked_choices(props.race, party);\n    }\n\n    let data = [];\n    for (const item in choices) {\n        let datapoints = [];\n        for (let i = 1; i < maxchoices + 1; i++) {\n            if (i in choices[item])\n                datapoints.push({ x: i, y: choices[item][i] })\n        }\n        data.push({\n            id: item,\n            color: find_party_by_name(item).party_color,\n            data: datapoints,\n        });\n    }\n\n    const getColor = bar => find_party_by_name(bar.id).party_color;\n\n    return (\n        <div style={props.style}>\n            <ResponsiveLine\n                data={data}\n                margin={{ top: 50, right: 110, bottom: 50, left: 60 }}\n                xScale={{ type: 'linear', min: 1 }}\n                yScale={{ type: 'linear', min: 0, max: 'auto', stacked: true, reverse: false }}\n                axisBottom={{\n                    orient: 'bottom',\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 0,\n                    legend: 'Round',\n                    legendOffset: 36,\n                    legendPosition: 'middle'\n                }}\n                axisLeft={{\n                    orient: 'left',\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 0,\n                    legend: 'Votes',\n                    legendOffset: -40,\n                    legendPosition: 'middle'\n                }}\n                colors={getColor}\n                enablePoints={false}\n                enableArea={true}\n                areaOpacity={1}\n                useMesh={true}\n            />\n        </div>\n    );\n}\n\nexport default PartyPercentage;\n","import React from 'react';\n\nimport { ResponsiveLine } from '@nivo/line'\n\nfunction CandidatesRanked(props) {\n    const get_ranked_choices = (race) => {\n        let ranked_choices = {};\n        for (const ballot of race.ballots) {\n            maxChoices = Math.max(ballot.candidates.length, maxChoices);\n        }\n        for (let i = 0; i < maxChoices; i++) {\n            ranked_choices[i] = 0;\n        }\n\n        for (const ballot of race.ballots) {\n            let eventualElected = false;\n            for (let i = 0; i < maxChoices; i++) {\n                if (i < ballot.candidates.length && !eventualElected) {\n                    for (const candidate in race.elected) {\n                        if (candidate === ballot.candidates[i].candidate_id)\n                            eventualElected = true;\n                    }\n                }\n\n                if (eventualElected)\n                    ranked_choices[i] += 1;\n            }\n        }\n        return ranked_choices;\n    }\n\n    let maxChoices = 0;\n    let choices = get_ranked_choices(props.race);\n\n    let electeddatapoints = [];\n    for (let i = 1; i < maxChoices + 1; i++) {\n        if (i in choices)\n            electeddatapoints.push({ x: i, y: choices[i] })\n    }\n\n    let notelecteddatapoints = [];\n    for (let i = 1; i < maxChoices + 1; i++) {\n        if (i in choices)\n            notelecteddatapoints.push({ x: i, y: (props.race.ballots.length - choices[i]) })\n    }\n\n    let data =\n        [{\n            id: \"elected\",\n            color: \"red\",\n            data: electeddatapoints\n        },\n        {\n            id: \"notelected\",\n            color: \"blue\",\n            data: notelecteddatapoints,\n        }]\n\n    const getColor = bar => {\n        console.log(bar.id);\n        if (bar.id === \"elected\")\n            return \"#0d00ff\";\n        return '#ff0000';\n    }\n\n    return (\n        <div style={props.style}>\n            <ResponsiveLine\n                data={data}\n                margin={{ top: 50, right: 110, bottom: 50, left: 60 }}\n                xScale={{ type: 'linear', min: 1 }}\n                yScale={{ type: 'linear', min: 0, max: 'auto', stacked: true, reverse: false }}\n                axisBottom={{\n                    orient: 'bottom',\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 0,\n                    legend: 'Round',\n                    legendOffset: 36,\n                    legendPosition: 'middle'\n                }}\n                axisLeft={{\n                    orient: 'left',\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 0,\n                    legend: 'Votes',\n                    legendOffset: -40,\n                    legendPosition: 'middle'\n                }}\n                colors={getColor}\n                enablePoints={false}\n                enableArea={true}\n                areaOpacity={1}\n                useMesh={true}\n            />\n        </div>\n    );\n}\n\nexport default CandidatesRanked;\n","import React from 'react';\n\nimport { ResponsiveLineCanvas } from '@nivo/line'\n\nfunction VoteOverTime(props) {\n    const find_party_by_name = (name) => {\n        for (let i = 0; i < props.parties.length; i++)\n            if (props.parties[i].party_name === name)\n                return props.parties[i];\n        return null\n    };\n\n    const find_candidate_by_id = (candidate_id) => {\n        for (let i = 0; i < props.race.candidates.length; i++)\n            if (String(props.race.candidates[i].candidate_id) === candidate_id)\n                return props.race.candidates[i];\n        return null;\n    };\n\n    let choices_over_time = {};\n    for (const party of props.parties) {\n        choices_over_time[party.party_name] = [];\n    }\n\n    let increment = 1;\n    if (props.race.first_scores.length > 50)\n        increment = Math.floor(props.race.first_scores.length / 100);\n\n    for (let i = 0; i < props.race.first_scores.length; i += 1) {\n        const score_chart = props.race.first_scores[i];\n\n        let choices = {}\n        for (const party of props.parties) {\n            choices[party.party_name] = 0;\n        }\n\n        for (const candidate_id in score_chart) {\n            const candidate = find_candidate_by_id(candidate_id);\n            choices[candidate.candidate_party.party_name] += score_chart[candidate_id];\n        }\n\n        for (const party of props.parties) {\n            choices_over_time[party.party_name] = [...choices_over_time[party.party_name], choices[party.party_name]];\n        }\n    }\n\n    let data = [];\n    for (const item in choices_over_time) {\n        let datapoints = [];\n        for (let i = 0; i < choices_over_time[item].length; i++) {\n            if (choices_over_time[item][i] !== 0) {\n                datapoints.push({ x: (i * 1), y: ((choices_over_time[item][i]) / ((i + 1) * 1) * 100) })\n            }\n        }\n        data.push({\n            id: item,\n            color: find_party_by_name(item).party_color,\n            data: datapoints,\n        });\n    }\n\n    const getColor = bar => find_party_by_name(bar.id).party_color;\n\n\n    return (\n        <div style={props.style}>\n            <ResponsiveLineCanvas\n                data={data}\n                margin={{ top: 50, right: 160, bottom: 50, left: 60 }}\n                xScale={{ type: 'linear' }}\n                xFormat={',.2r'}\n                yScale={{ type: 'linear', stacked: false, min: 0, max: 100 }}\n                yFormat={',.2r'}\n                axisBottom={{\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 0,\n                    tickValues: 5,\n                    legend: 'Votes',\n                    legendOffset: 36,\n                    legendPosition: 'middle'\n                }}\n                axisLeft={{\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 0,\n                    legend: 'Percentage',\n                    legendOffset: -40,\n                    legendPosition: 'middle'\n                }}\n                enableGridX={false}\n                colors={getColor}\n                lineWidth={1}\n                enablePoints={false}\n            />\n        </div>\n    );\n}\n\nexport default VoteOverTime;\n","import React from 'react';\n\nimport { ResponsiveBump } from '@nivo/bump'\n\n\nfunction VoteOverTimeBump(props) {\n    const indexOfMax = (arr) => {\n        if (arr.length === 0) {\n            return -1;\n        }\n\n        var max = arr[0];\n        var maxIndex = 0;\n\n        for (var i = 1; i < arr.length; i++) {\n            if (arr[i] > max) {\n                maxIndex = i;\n                max = arr[i];\n            }\n        }\n\n        return maxIndex;\n    }\n\n\n    let choices_over_time = [];\n\n    if (props.race.first_scores.length <= 1)\n        return (<div></div>);\n\n    let increment = 1;\n    if (props.race.first_scores.length > 50)\n        increment = Math.floor(props.race.first_scores.length / 50);\n\n    for (let i = 0; i < props.race.first_scores.length; i += increment) {\n        const score_chart = props.race.first_scores[i]\n\n        let candidate_positions = {};\n        let candidates = []\n        let scores = []\n        for (const candidate of props.race.candidates) {\n            candidates.push(candidate);\n            if (candidate.candidate_id in score_chart)\n                scores.push(score_chart[candidate.candidate_id]);\n            else\n                scores.push(0);\n        }\n\n        let position = 1;\n        while (scores.length > 0) {\n            let i = indexOfMax(scores);\n            scores.splice(i, 1);\n            candidate_positions[candidates[i].candidate_id] = position;\n            candidates.splice(i, 1);\n            position++;\n        }\n        choices_over_time.push(candidate_positions);\n    }\n\n\n    let data = [];\n    for (const candidate of props.race.candidates) {\n        let datapoint = []\n        for (let i = 0; i < choices_over_time.length; i++) {\n            datapoint.push({ x: (i + 1) * increment, y: choices_over_time[i][candidate.candidate_id] });\n        }\n        data.push({ id: candidate.candidate_name, data: datapoint });\n    }\n    console.log(data);\n\n\n    return (\n        <div style={props.style}>\n            <ResponsiveBump\n                data={data}\n                margin={{ top: 40, right: 100, bottom: 40, left: 60 }}\n                colors={{ scheme: 'spectral' }}\n                lineWidth={3}\n                activeLineWidth={6}\n                inactiveLineWidth={3}\n                inactiveOpacity={0.15}\n                pointSize={0}\n                activePointSize={0}\n                inactivePointSize={0}\n                axisTop={null}\n                axisRight={null}\n                axisBottom={{\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 90,\n                    tickValues: 5,\n                    format: \".2s\",\n                    legend: '',\n                    legendPosition: 'middle',\n                    legendOffset: 32\n                }}\n                axisLeft={{\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 0,\n                    legend: 'ranking',\n                    legendPosition: 'middle',\n                    legendOffset: -40\n                }}\n            />\n        </div>\n    );\n}\n\nexport default VoteOverTimeBump;\n","import React from 'react';\n\nimport { ResponsiveBump } from '@nivo/bump'\n\n\nfunction RoundCandidateBump(props) {\n    let data = []\n\n    for (const candidate of props.race.candidates) {\n        let datapoint = []\n        for (const round of props.race.rounds) {\n            if (round.elected_candidates.includes(candidate)) {\n                datapoint.push({ x: round.round_number + 1, y: props.race.elected[candidate.candidate_id][1] + 1 });\n            } else if (round.eliminated_candidates.includes(candidate)) {\n                if (candidate.candidate_id in props.race.transferring)\n                    datapoint.push({ x: round.round_number + 1, y: props.race.transferring[candidate.candidate_id][1] + 1 });\n                else\n                    datapoint.push({ x: round.round_number + 1, y: props.race.transfered[candidate.candidate_id][1] + 1 });\n            } else {\n                let active_candidates = round.active_candidates.sort((x, y) => {\n                    if (round.candidate_score(x) > round.candidate_score(y)) {\n                        return -1;\n                    } else if (round.candidate_score(y) > round.candidate_score(x)) {\n                        return 1;\n                    }\n                    return 0;\n                });\n                datapoint.push({ x: round.round_number + 1, y: active_candidates.indexOf(candidate) + round.elected_candidates.length + 1 });\n            }\n        }\n        data.push({ id: candidate.candidate_name, data: datapoint });\n    }\n\n\n    return (\n        <div style={props.style}>\n            <ResponsiveBump\n                data={data}\n                margin={{ top: 40, right: 100, bottom: 40, left: 60 }}\n                colors={{ scheme: 'spectral' }}\n                lineWidth={3}\n                activeLineWidth={6}\n                inactiveLineWidth={3}\n                inactiveOpacity={0.15}\n                pointSize={0}\n                activePointSize={0}\n                inactivePointSize={0}\n                pointColor={{ theme: 'background' }}\n                pointBorderWidth={3}\n                activePointBorderWidth={3}\n                pointBorderColor={{ from: 'serie.color' }}\n                axisTop={{\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 0,\n                    legend: '',\n                    legendPosition: 'middle',\n                    legendOffset: -36\n                }}\n                axisRight={null}\n                axisBottom={{\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 0,\n                    legend: '',\n                    legendPosition: 'middle',\n                    legendOffset: 32\n                }}\n                axisLeft={{\n                    tickSize: 5,\n                    tickPadding: 5,\n                    tickRotation: 0,\n                    legend: 'ranking',\n                    legendPosition: 'middle',\n                    legendOffset: -40\n                }}\n            />\n        </div>\n    );\n}\n\nexport default RoundCandidateBump;\n","import { CandidateState } from \"./Candidate\";\n\nexport class Round {\n    constructor(round_number, quota) {\n        this.round_number = round_number;\n        this.quota = quota;\n        this.state = RoundState.RUNNING;\n\n        this.candidates = []\n\n        this.elected_candidates = []\n        this.active_candidates = []\n        this.start_inactive_candidates = []\n        this.start_active_candidates = []\n        this.eliminated_candidates = []\n\n        this.ballots = { exhausted: 0 }\n        this.ballotsToTransfer = {}\n        this.candidate_ballots = { exhausted: [] }\n        this.candidate_real_scores = {}\n        this.candidate_scores = { exhausted: 0 }\n        this.rankings = {};\n    }\n\n    add_ballot = (ballot, value) => {\n        if (this.state === RoundState.COMPLETE)\n            throw new Error(\"Can't Add Ballot to Complete Round\");\n\n        if (this.ballots[ballot.ballot_id] !== undefined)\n            throw new Error(\"Already added Ballot\");\n\n        let candidate = this.find_next_active_candidate(ballot.candidates);\n        if (candidate !== \"exhausted\") {\n            this.candidate_ballots[candidate.candidate_id].push(ballot);\n            this.candidate_scores[candidate.candidate_id] += value;\n        } else {\n            this.candidate_ballots[candidate].push(ballot);\n            this.candidate_scores[candidate] += value;\n        }\n        this.ballots[ballot.ballot_id] = value;\n    }\n\n    find_next_active_candidate = (candidates) => {\n        for (const candidate of candidates)\n            if (this.active_candidates.includes(candidate))\n                return candidate\n        return \"exhausted\";\n    }\n\n    add_candidate = (candidate, state) => {\n        if (this.state === RoundState.COMPLETE)\n            throw new Error(\"Can't Add Ballot to Complete Round\");\n\n        this.candidates.push(candidate);\n        if (state === CandidateState.ELECTED) {\n            this.elected_candidates.push(candidate);\n            this.start_inactive_candidates.push(candidate);\n        } else if (state === CandidateState.RUNNING) {\n            this.active_candidates.push(candidate);\n            this.start_active_candidates.push(candidate);\n        } else {\n            this.eliminated_candidates.push(candidate);\n            this.start_inactive_candidates.push(candidate);\n        }\n\n        this.candidate_ballots[candidate.candidate_id] = [];\n        this.candidate_scores[candidate.candidate_id] = 0;\n    }\n\n    set_elected_candidate = (candidate) => {\n        if (this.state === RoundState.COMPLETE)\n            throw new Error(\"Round Complete\");\n\n        this.active_candidates = this.active_candidates.filter((value) => {\n            return value !== candidate\n        });\n\n        this.ballotsToTransfer[candidate.candidate_id] = { ...this.candidate_ballots[candidate.candidate_id] }\n        this.elected_candidates.push(candidate);\n    }\n\n    set_eliminate_candidate = (candidate) => {\n        if (this.state === RoundState.COMPLETE)\n            throw new Error(\"Round Complete\");\n\n        this.active_candidates = this.active_candidates.filter((value) => {\n            return value !== candidate\n        });\n\n        this.ballotsToTransfer[candidate.candidate_id] = { ...this.candidate_ballots[candidate.candidate_id] }\n        this.eliminated_candidates.push(candidate);\n    }\n\n    candidate_ballot = (candidate) => {\n        if (candidate === null)\n            candidate = \"exhausted\";\n        else if (candidate.candidate_id !== undefined)\n            candidate = candidate.candidate_id;\n\n        let ballots = [];\n        for (const ballot of this.candidate_ballots[candidate]) {\n            ballots.push([ballot, this.ballots[ballot.ballot_id]]);\n        }\n        return ballots;\n    }\n\n    candidate_score = (candidate) => {\n        return this.candidate_scores[candidate.candidate_id];\n    }\n\n    complete = () => {\n        const isCandidateElected = (candidate_id) => {\n            for (const candidate in this.elected_candidates) {\n                if (candidate_id === this.elected_candidates[candidate].candidate_id) {\n                    return true;\n                }\n            }\n            return false;\n        }\n        this.candidate_real_scores = { ...this.candidate_scores }\n        for (const candidate_id in this.candidate_real_scores) {\n            if (this.candidate_real_scores[candidate_id] === 0 && isCandidateElected(candidate_id)) {\n                this.candidate_real_scores[candidate_id] = this.quota;\n            }\n        }\n\n        this.state = RoundState.COMPLETE;\n    }\n}\n\nexport const RoundState = {\n    RUNNING: \"RUNNING\",\n    COMPLETE: \"COMPLETE\"\n};","\nimport { Round, RoundState } from './Round';\nimport { CandidateState } from './Candidate';\n\nexport class Race {\n\n    constructor(race_id, race_name, seats) {\n        this.race_id = race_id\n        this.race_name = race_name\n        this.seats = seats\n\n        this.rounds = [];\n\n        this.state = RaceState.ADDING;\n\n        this.candidates = []\n        this.ballots = []\n\n        this.transfer_voters = []\n        this.ballots_to_apply = []\n        this.candidate_ballot_rankings = {}\n\n        this.first_scores = []\n\n        // Set Candidate States\n        this.elected = {}\n        this.running = {}\n        this.transferring = {}\n        this.transfered = {}\n    }\n\n    add_candidate = (candidate) => {\n        for (const current_candidate of this.candidates)\n            if (current_candidate.candidate_id === candidate.candidate_id)\n                return;\n        this.running[candidate.candidate_id] = [0, this.running.length];\n        this.candidates.push(candidate);\n    }\n\n    add_ballot = (ballot) => {\n        if (ballot.candidates.length === 0)\n            return;\n        for (let i = 0; i < this.ballots.length; i++)\n            if (this.ballots[i].ballot_id === ballot.ballot_id)\n                return;\n        this.ballots.push(ballot);\n    }\n\n    num_candidates = () => {\n        return this.candidates.length;\n    }\n\n    quota = () => {\n        if (this.state === RaceState.ADDING)\n            throw new Error(\"Can't Get Quota While Adding Ballots\");\n        return Math.floor(this.ballots.length / (this.seats + 1)) + 1;\n    }\n\n    currentScores = () => {\n        const find_candidate_by_id = (id) => {\n            for (const candidate of this.candidates)\n                if (candidate.candidate_id === id)\n                    return candidate;\n            return null;\n        }\n        let scores = [];\n        for (const candidate in this.elected) {\n            scores.push({\n                candidate: find_candidate_by_id(candidate),\n                score: this.elected[candidate][0],\n            });\n        }\n        for (const candidate in this.running) {\n            scores.push({\n                candidate: find_candidate_by_id(candidate),\n                score: this.running[candidate][0],\n            });\n        }\n        for (const candidate in this.transferring) {\n            scores.push({\n                candidate: find_candidate_by_id(candidate),\n                score: this.transferring[candidate][0],\n            });\n        }\n        for (const candidate in this.transfered) {\n            scores.push({\n                candidate: find_candidate_by_id(candidate),\n                score: this.transfered[candidate][0],\n            });\n        }\n        return scores;\n    }\n\n    candidateTable = () => {\n        const find_candidate_by_id = (id) => {\n            for (const candidate of this.candidates)\n                if (candidate.candidate_id === id)\n                    return candidate;\n            return null;\n        }\n        let quota = 0;\n        if (this.state !== RaceState.ADDING)\n            quota = this.quota();\n\n        let candidateTable = []\n        // Candidate, Status, Position, Score\n\n        for (const candidate in this.elected) {\n            candidateTable.push({\n                candidate: find_candidate_by_id(candidate),\n                status: CandidateState.ELECTED,\n                position: this.elected[candidate][1],\n                score: this.elected[candidate][0],\n                quota: quota,\n            });\n        }\n        for (const candidate in this.running) {\n            candidateTable.push({\n                candidate: find_candidate_by_id(candidate),\n                status: CandidateState.RUNNING,\n                position: this.running[candidate][1],\n                score: this.running[candidate][0],\n                quota: quota,\n            });\n        }\n        for (const candidate in this.transferring) {\n            candidateTable.push({\n                candidate: find_candidate_by_id(candidate),\n                status: CandidateState.TRANSFERRING,\n                position: this.transferring[candidate][1],\n                score: this.transferring[candidate][0],\n                quota: quota,\n            });\n        }\n        for (const candidate in this.transfered) {\n            candidateTable.push({\n                candidate: find_candidate_by_id(candidate),\n                status: CandidateState.TRANSFERED,\n                position: this.transfered[candidate][1],\n                score: this.transfered[candidate][0],\n                quota: quota,\n            });\n        }\n        return candidateTable;\n    }\n\n    start_tabulation = () => {\n        if (this.state === RaceState.ADDING)\n            this.state = RaceState.TABULATING;\n    }\n\n    run_race_step = () => {\n        const begin_race = () => {\n            console.log(\"Beginning Race for\", this.race_name);\n            console.log(\"Quota is\", this.quota())\n            if (this.ballots.length === 0) {\n                this.state = RaceState.COMPLETE;\n                console.log(\"No Ballots Cast in Race\");\n            }\n            else {\n                let round = new Round(0, this.quota());\n\n                for (let i = 0; i < this.candidates.length; i++) {\n                    round.add_candidate(this.candidates[i], CandidateState.RUNNING);\n                }\n\n\n                for (let i = 0; i < this.ballots.length; i++) {\n                    this.ballots_to_apply.push([this.ballots[i], 1]);\n                }\n                this.rounds.push(round);\n            }\n        }\n\n        const add_round = () => {\n            const find_candidate_by_id = (id) => {\n                for (const candidate of this.candidates)\n                    if (candidate.candidate_id === id)\n                        return candidate;\n                return null;\n            }\n            console.log(\"Starting Round\", this.rounds.length);\n            let round = new Round(this.rounds.length, this.quota());\n            let previousRound = this.rounds[this.rounds.length - 1];\n\n            for (const candidate in this.elected) {\n                round.add_candidate(find_candidate_by_id(candidate), CandidateState.ELECTED);\n            }\n            for (const candidate in this.running) {\n                round.add_candidate(find_candidate_by_id(candidate), CandidateState.RUNNING);\n                for (const ballot of previousRound.candidate_ballot(candidate)) {\n                    round.add_ballot(ballot[0], ballot[1]);\n                }\n            }\n            for (const candidate in this.transferring) {\n                round.add_candidate(find_candidate_by_id(candidate), CandidateState.TRANSFERRING);\n            }\n            for (const candidate in this.transfered) {\n                round.add_candidate(find_candidate_by_id(candidate), CandidateState.TRANSFERED);\n            }\n\n            for (const ballot of previousRound.candidate_ballot(null)) {\n                round.add_ballot(ballot[0], ballot[1]);\n            }\n\n            this.rounds.push(round);\n        }\n\n        const elect_candidate = (candidate, score, currentRound) => {\n            console.log(\"Electing Candidate: \", candidate.candidate_name, \" (\", score, \")\");\n            currentRound.set_elected_candidate(candidate);\n\n            this.elected[candidate.candidate_id] = [score, Object.keys(this.elected).length];\n            delete this.running[candidate.candidate_id];\n\n            const surplus = score - this.quota();\n\n            let transfer_value = 1;\n            if (surplus > 0) {\n                transfer_value = surplus / score;\n            }\n\n            for (const ballot of currentRound.candidate_ballot(candidate)) {\n                this.ballots_to_apply.push([ballot[0], ballot[1] * transfer_value]);\n            }\n        }\n\n        const transfer_candidate = (candidate, score, currentRound) => {\n            console.log(\"Transferring Candidate \", candidate.candidate_name, \" (\", score, \")\");\n            currentRound.set_eliminate_candidate(candidate);\n\n            this.transferring[candidate.candidate_id] = [score, Object.keys(this.elected).length + Object.keys(this.running).length - 1];\n            delete this.running[candidate.candidate_id];\n\n            for (const ballot of currentRound.candidate_ballot(candidate))\n                this.ballots_to_apply.push(ballot)\n        }\n\n        const complete_round = (currentRound) => {\n            console.log(\"Completed Round\", currentRound.round_number);\n            currentRound.complete();\n\n            if (currentRound.active_candidates.length === 0) {\n                console.log(\"Race Complete\");\n                for (const candidate in this.transferring) {\n                    this.transfered[candidate] = this.transferring[candidate];\n                    delete this.transferring[candidate]\n                }\n                console.log(this.rounds);\n                this.state = RaceState.COMPLETE;\n            }\n        }\n\n        if (this.state === RaceState.COMPLETE)\n            return;\n        this.state = RaceState.TABULATING;\n\n        if (this.rounds.length === 0) {\n            begin_race();\n            return;\n        }\n\n        let currentRound = this.rounds[this.rounds.length - 1];\n        if (currentRound.state === RoundState.COMPLETE) {\n            add_round();\n            return;\n        }\n\n        if (this.ballots_to_apply.length > 0) {\n            let ballot = this.ballots_to_apply.shift();\n            currentRound.add_ballot(ballot[0], ballot[1]);\n\n            if (this.rounds.length === 1) {\n                for (let i = 0; i < ballot[0].candidates.length; i++) {\n                    const candidate = ballot[0].candidates[i];\n                    if (this.candidate_ballot_rankings[candidate] === undefined)\n                        this.candidate_ballot_rankings[candidate] = [];\n                    while (this.candidate_ballot_rankings[candidate].length < i + 1)\n                        this.candidate_ballot_rankings[candidate].push(0);\n                    this.candidate_ballot_rankings[candidate][i] += 1\n                }\n\n                let first_round_score = {};\n                if (this.first_scores.length !== 0) {\n                    first_round_score = { ...this.first_scores[this.first_scores.length - 1] };\n                }\n                if (ballot[0].candidates[0].candidate_id in first_round_score)\n                    first_round_score[ballot[0].candidates[0].candidate_id] += 1;\n                else\n                    first_round_score[ballot[0].candidates[0].candidate_id] = 1;\n                this.first_scores.push(first_round_score);\n            }\n\n            let activeCandidates = currentRound.active_candidates.sort((x, y) => {\n                if (currentRound.candidate_score(x) > currentRound.candidate_score(y)) {\n                    return -1;\n                } else if (currentRound.candidate_score(y) > currentRound.candidate_score(x)) {\n                    return 1;\n                }\n                return 0;\n            });\n\n            for (let i = 0; i < activeCandidates.length; i++) {\n                this.running[activeCandidates[i].candidate_id] = [currentRound.candidate_score(activeCandidates[i]), Object.keys(this.elected).length + i];\n            }\n\n            return;\n        }\n\n        for (const candidate in this.transferring) {\n            this.transfered[candidate] = this.transferring[candidate];\n            delete this.transferring[candidate]\n        }\n\n        let activeCandidates = currentRound.active_candidates.sort((x, y) => {\n            if (currentRound.candidate_score(x) > currentRound.candidate_score(y)) {\n                return -1;\n            } else if (currentRound.candidate_score(y) > currentRound.candidate_score(x)) {\n                return 1;\n            }\n            return 0;\n        });\n\n        let roundElected = [];\n        let maxElected = this.seats - Object.keys(this.elected).length;\n\n        if (activeCandidates.length <= maxElected) {\n            for (const candidate of activeCandidates) {\n                if (currentRound.elected_candidates) {\n                    roundElected.push(candidate);\n                }\n            }\n        } else {\n            for (const candidate of activeCandidates) {\n                if (currentRound.candidate_score(candidate) >= this.quota()) {\n                    roundElected.push(candidate);\n                }\n            }\n        }\n\n        for (const candidate of roundElected) {\n            elect_candidate(candidate, currentRound.candidate_score(candidate), currentRound);\n        }\n\n        let roundTransfer = [];\n        if (Object.keys(this.elected).length === this.seats) {\n            for (const candidate of activeCandidates.reverse()) {\n                roundTransfer.push(candidate);\n            }\n        } else if (roundElected.length === 0) {\n            roundTransfer.push(activeCandidates[activeCandidates.length - 1]);\n        }\n\n        for (const candidate of roundTransfer) {\n            if (!currentRound.elected_candidates.includes(candidate)) {\n                transfer_candidate(candidate, currentRound.candidate_score(candidate), currentRound);\n            }\n        }\n\n        complete_round(currentRound);\n    }\n};\n\nexport const RaceState = {\n    ADDING: \"ADDING\",\n    TABULATING: \"TABULATING\",\n    COMPLETE: \"COMPLETE\"\n};","\nexport class Voter {\n    constructor(voter_id) {\n        this.voter_id = voter_id;\n\n        // Format\n        // {id: Ballot}\n        this.races = {};\n    }\n\n    participating_races = () => {\n        return Object.keys(this.races);\n    }\n\n    participating_in_race = (race_id) => {\n        return race_id in this.races;\n    }\n\n    get_ballot_for_race = (race_id) => {\n        if (race_id in this.races) {\n            return this.races[race_id];\n        }\n        return null;\n    }\n\n    add_ballot = (race_id, ballot) => {\n        if (ballot.candidates.length > 0) {\n            this.races[race_id] = ballot;\n        }\n    }\n}","\nexport class Ballot {\n    constructor(ballot_id, candidates) {\n        this.ballot_id = ballot_id;\n        this.candidates = candidates;\n    }\n}","\nexport class Party {\n    constructor(party_name, party_color) {\n        this.party_name = party_name;\n\n        if (!this.isValidColor(party_color)) {\n            party_color = \"#\" + party_color\n            if (!this.isValidColor(party_color)) {\n                console.log(\"Error Color Isn't Valid\", party_color)\n            }\n        }\n        this.party_color = party_color;\n    }\n\n    isValidColor = (color) => {\n        var s = new Option().style;\n        s.color = color;\n        return s.color !== '';\n    }\n}","import React from 'react';\n\nimport { ResponsiveSankey } from '@nivo/sankey'\n\nfunction Sankey(props) {\n\n    const GenerateData = (race) => {\n        const find_candidate_by_id = (candidate_id) => {\n            for (let i = 0; i < race.candidates.length; i++)\n                if (String(race.candidates[i].candidate_id) === candidate_id)\n                    return race.candidates[i];\n            return null;\n        };\n\n        const find_next_active_candidate = (candidates, active_candidates) => {\n            for (const candidate in candidates) {\n                for (const active_candidate in active_candidates) {\n                    if (candidates[candidate].candidate_id === active_candidates[active_candidate].candidate_id) {\n                        return candidates[candidate];\n                    }\n                }\n            }\n            return \"exhausted\";\n        }\n\n        const prev_round = (round) => {\n            return race.rounds[round.round_number - 1];\n        }\n\n        let data = { nodes: [{ id: \"Total Votes\", name: \"Total Votes\", color: \"#000000\" }, { id: \"Elected\", name: \"Elected\", color: \"#01A039\" }, { id: \"Exhausted\", name: \"Exhausted\", color: \"#FF0000\" }], links: [] }\n        for (const round_number in race.rounds) {\n            const round = race.rounds[round_number];\n            for (const candidate of round.start_active_candidates) {\n                data[\"nodes\"].push({ id: candidate.candidate_name + \" \" + round_number, name: candidate.candidate_name, color: candidate.candidate_party.party_color });\n            }\n            if (round.round_number === 0) {\n                // First Round so Count Vote Totals\n                for (const candidate of round.start_active_candidates) {\n                    let link = { source: \"Total Votes\", target: candidate.candidate_name + \" \" + round.round_number, value: round.candidate_real_scores[candidate.candidate_id] };\n                    data['links'].push(link);\n                }\n            } else {\n                // First add links from prior rounds\n                for (const candidate of round.start_active_candidates) {\n                    let link = { source: candidate.candidate_name + \" \" + (round.round_number - 1), target: candidate.candidate_name + \" \" + round.round_number, value: prev_round(round).candidate_real_scores[candidate.candidate_id] };\n                    data['links'].push(link);\n                    // Check if elected this round and add link if elected\n                    if (round.elected_candidates.includes(candidate) && round.round_number !== race.rounds.length - 1) {\n                        let link = { source: candidate.candidate_name + \" \" + round.round_number, target: \"Elected\", value: round.quota, color: \"#01A039\" };\n                        data['links'].push(link);\n                    }\n                }\n\n                // Then add links from eliminated or elected candidates\n                for (const candidate_id in prev_round(round).ballotsToTransfer) {\n                    const candidate = find_candidate_by_id(candidate_id);\n\n                    // Find candidates that it will transfer to\n                    let transfer_candidates_ballot = {};\n\n                    let candidate_ballots = prev_round(round).ballotsToTransfer[candidate_id];\n                    for (const ballot in candidate_ballots) {\n                        const next_candidate = find_next_active_candidate(candidate_ballots[ballot].candidates, round.start_active_candidates);\n                        if (next_candidate !== \"exhausted\") {\n                            if (next_candidate.candidate_id in transfer_candidates_ballot)\n                                transfer_candidates_ballot[next_candidate.candidate_id].push(candidate_ballots[ballot])\n                            else\n                                transfer_candidates_ballot[next_candidate.candidate_id] = [candidate_ballots[ballot]];\n                        } else {\n                            if (next_candidate in transfer_candidates_ballot)\n                                transfer_candidates_ballot[next_candidate].push(candidate_ballots[ballot])\n                            else\n                                transfer_candidates_ballot[next_candidate] = [candidate_ballots[ballot]];\n                        }\n                    }\n\n\n                    for (const transfer_candidate_id in transfer_candidates_ballot) {\n                        if (transfer_candidate_id !== \"exhausted\") {\n                            const transfer_candidate = find_candidate_by_id(transfer_candidate_id);\n\n                            let value = 0;\n                            for (const ballot in transfer_candidates_ballot[transfer_candidate_id]) {\n                                value += round.ballots[transfer_candidates_ballot[transfer_candidate_id][ballot].ballot_id];\n                            }\n                            let link = { source: candidate.candidate_name + \" \" + (round.round_number - 1), target: transfer_candidate.candidate_name + \" \" + round.round_number, value: value };\n                            data['links'].push(link);\n                        }\n                        else {\n                            let value = 0;\n                            for (const ballot in transfer_candidates_ballot[transfer_candidate_id]) {\n                                value += round.ballots[transfer_candidates_ballot[transfer_candidate_id][ballot].ballot_id];\n                            }\n                            let link = { source: candidate.candidate_name + \" \" + (round.round_number - 1), target: \"Exhausted\", value: value };\n                            data['links'].push(link);\n                        }\n                    }\n                }\n            }\n            if (round.round_number === race.rounds.length - 1) {\n                for (const candidate of round.start_active_candidates) {\n                    if (round.elected_candidates.includes(candidate)) {\n                        let link = { source: candidate.candidate_name + \" \" + round.round_number, target: \"Elected\", value: round.candidate_real_scores[candidate.candidate_id] };\n                        data['links'].push(link);\n                    }\n                    else {\n                        let link = { source: candidate.candidate_name + \" \" + round.round_number, target: \"Exhausted\", value: round.candidate_real_scores[candidate.candidate_id] };\n                        data['links'].push(link);\n                    }\n                }\n            }\n        }\n        return data;\n    }\n\n    if (props.race.rounds.length === 0)\n        return (<h1>Loading</h1>)\n\n\n    const data = GenerateData(props.race);\n\n    return (\n        <div style={props.style}>\n            <ResponsiveSankey\n                data={data}\n                margin={{ top: 100, right: 40, bottom: 100, left: 40 }}\n                layout=\"vertical\"\n                align=\"justify\"\n                sort=\"descending\"\n                colors={{ scheme: 'category10' }}\n                nodeOpacity={1}\n                nodeThickness={10}\n                nodeInnerPadding={3}\n                nodeSpacing={10}\n                nodeBorderWidth={0}\n                nodeBorderColor={{ from: 'color', modifiers: [['darker', 0.8]] }}\n                linkOpacity={0.4}\n                linkHoverOpacity={0.8}\n                linkHoverOthersOpacity={0.1}\n                enableLinkGradient={true}\n                enableLabels={true}\n                label={node => `${node.name}`}\n                labelPosition=\"outside\"\n                labelOrientation=\"vertical\"\n                labelPadding={16}\n                labelTextColor={{ from: 'color', modifiers: [['darker', 1]] }}\n                animate={true}\n                motionStiffness={90}\n                motionDamping={15}\n            />\n        </div>\n    );\n}\n\nexport default Sankey;","import React, { useState } from 'react';\n\nimport { ResponsiveBarCanvas } from '@nivo/bar';\n\nimport { RaceState } from '../../../Data_Models/Race';\nimport RangeSlider from 'react-bootstrap-range-slider';\n\n\nfunction ElectionBar(props) {\n    const get_round_data = (round, active_candidates) => {\n        let round_data = {};\n        for (let i = 0; i < active_candidates.length; i++) {\n            round_data[active_candidates[i].candidate_id] = { position: i, score: round.candidate_score(active_candidates[i]) }\n        }\n        return round_data;\n    }\n\n    const get_candidate_position = (candidate) => {\n        for (const candidate_table of candidateTable) {\n            if (candidate_table.candidate.candidate_id === candidate.candidate_id) {\n                return candidate_table.position;\n            }\n        }\n        return 0;\n    }\n\n    const get_max_score = () => {\n        let max_score = quota;\n        for (const candidate_table of candidateTable) {\n            max_score = Math.max(candidate_table.score, max_score);\n        }\n        return max_score\n    }\n\n    const get_candidate_by_position = (position) => {\n        for (const candidate of props.race.candidates) {\n            if (get_candidate_position(candidate) === position) {\n                return candidate;\n            }\n        }\n        return 0;\n    }\n\n    const final_candidate_score = (candidate) => {\n        for (const candidate_table of candidateTable) {\n            if (candidate_table.candidate.candidate_id === candidate.candidate_id) {\n                return candidate_table.score;\n            }\n        }\n        return 0;\n    }\n\n    const [round, setRound] = useState(1);\n    const candidateTable = props.race.candidateTable();\n\n    if (props.race.rounds === 0 || props.race.state === RaceState.ADDING)\n        return <h1> Loading... </h1>\n\n    let quota = props.race.quota();\n\n    let data_active_candidates = [];\n    // Get Candidates to Display\n    let round_active_candidates = props.race.rounds[round - 1].active_candidates;\n    for (let i = 0; i < round; i++) {\n        data_active_candidates.push(get_round_data(props.race.rounds[i],\n            round_active_candidates));\n    }\n\n    let keys = [\"elected\", \"transferred\"]\n    let chart_data = [];\n\n    for (let i = 0; i < props.race.rounds[round - 1].candidates.length; i++) {\n        const candidate = get_candidate_by_position(i);\n        if (round_active_candidates.includes(candidate)) {\n            let data = { candidate: candidate.candidate_name };\n            for (let i = 0; i < round; i++) {\n                let score = data_active_candidates[i][candidate.candidate_id].score;\n                if (i !== 0) {\n                    score -= data_active_candidates[i - 1][candidate.candidate_id].score;\n                }\n                data[\"Round \" + (i + 1)] = score;\n                if (!keys.includes(\"Round \" + (i + 1))) {\n                    keys.push(\"Round \" + (i + 1));\n                }\n            }\n            chart_data.push(data);\n        } else if (props.race.rounds[round - 1].elected_candidates.includes(candidate)) {\n            chart_data.push({ candidate: candidate.candidate_name, elected: props.race.rounds[round - 1].candidate_real_scores[candidate.candidate_id] });\n        } else {\n            chart_data.push({ candidate: candidate.candidate_name, transferred: final_candidate_score(candidate) });\n        }\n    }\n    return (\n        <div style={{ width: '100%', height: '50vw' }}>\n            <RangeSlider\n                min={1}\n                max={props.race.rounds.length}\n                step={1}\n                value={round}\n                variant=\"secondary\"\n                onChange={changeEvent => setRound(changeEvent.target.value)}\n            />\n            <div style={{ width: '100%', height: '50vw' }}>\n                <ResponsiveBarCanvas\n                    data={chart_data}\n                    keys={keys}\n                    indexBy=\"candidate\"\n                    margin={{ top: 40, right: 40, bottom: 200, left: 60 }}\n                    maxValue={get_max_score()}\n                    pixelRatio={2}\n                    padding={0.05}\n                    innerPadding={0}\n                    groupMode=\"stacked\"\n                    layout=\"vertical\"\n                    reverse={false}\n                    colors={{ scheme: 'nivo' }}\n                    colorBy=\"id\"\n                    borderWidth={0}\n                    borderColor={{ from: 'color', modifiers: [['darker', 1.6]] }}\n                    axisBottom={{\n                        tickSize: 5,\n                        tickPadding: 5,\n                        tickRotation: -60,\n                    }}\n                    axisLeft={{\n                        tickSize: 5,\n                        tickPadding: 5,\n                        tickRotation: 0,\n                        legend: 'Score',\n                        legendPosition: 'middle',\n                        legendOffset: -40\n                    }}\n                    enableGridX={false}\n                    enableGridY={true}\n                    enableLabel={false}\n                    labelSkipWidth={12}\n                    labelSkipHeight={12}\n                    labelTextColor={{ from: 'color', modifiers: [['darker', 1.6]] }}\n                    isInteractive={true}\n                />\n            </div>\n        </div>\n    );\n}\n\nexport default ElectionBar;\n","import React, { useState, useEffect } from 'react';\nimport firebase from 'firebase';\nimport uuid from 'react-uuid'\n\nimport DropdownButton from 'react-bootstrap/DropdownButton'\nimport { Dropdown } from 'react-bootstrap';\nimport Button from 'react-bootstrap/Button'\nimport ButtonGroup from 'react-bootstrap/ButtonGroup'\nimport 'react-bootstrap-range-slider/dist/react-bootstrap-range-slider.css';\nimport RangeSlider from 'react-bootstrap-range-slider';\n\nimport useInterval from '../Hooks/useInterval';\nimport CandidateList from './Race/CandidateList';\n\nimport FirstChoicePie from './Models/FirstChoicePie';\nimport ElectedCandidatesPie from './Models/ElectedCandidatesPie';\nimport CandidatesRanked from './Models/CandidatesRanked';\nimport PartyPercentage from './Models/PartyPercentage';\nimport EventualWinner from './Models/EventualWinner';\nimport VoteOverTime from './Models/VoteOverTime';\nimport VoteOverTimeBump from './Models/VoteOverTimeBump';\nimport RoundCandidateBump from './Models/RoundCandidateBump';\n\nimport { Race } from '../../Data_Models/Race';\nimport { Voter } from '../../Data_Models/Voter';\nimport { Ballot } from '../../Data_Models/Ballot';\nimport { Party } from '../../Data_Models/Party';\nimport { Candidate } from '../../Data_Models/Candidate';\n\nimport './ElectionPage.css'\nimport { RoundState } from '../../Data_Models/Round';\nimport NivoSankey from './Models/Sankey';\nimport ElectionBar from './Models/ElectionBar';\n\nfunction ElectionPage(props) {\n\n    // Helper Functions\n    const find_race_by_id = (id) => {\n        for (let i = 0; i < races.length; i++) {\n            if (String(races[i].race_id) === id)\n                return races[i];\n        }\n        return null;\n    };\n\n    const find_race_by_name = (name) => {\n        for (let i = 0; i < races.length; i++) {\n            if (races[i].race_name === name)\n                return races[i];\n        }\n        return null;\n    };\n\n    const find_candidate_by_id = (race_id, candidate_id) => {\n        let race = find_race_by_id(race_id);\n        if (race !== null)\n            for (let i = 0; i < race.candidates.length; i++)\n                if (String(race.candidates[i].candidate_id) === candidate_id)\n                    return race.candidates[i];\n        return null;\n    };\n\n    const find_party_by_name = (name) => {\n        for (let i = 0; i < parties.length; i++)\n            if (parties[i].party_name === name)\n                return parties[i];\n        return null\n    };\n\n    const loadParties = (party_data) => {\n        let partiesToAdd = []\n        for (const party of party_data.parties) {\n            for (let i = 0; i < partiesToAdd.length; i++)\n                if (partiesToAdd.party_name === party.party_name)\n                    continue;\n            partiesToAdd.push(new Party(party.party_name, party.party_color));\n        }\n        return partiesToAdd;\n    }\n\n    const loadRaces = (election_configuration) => {\n        let racesToAdd = []\n        for (const race of election_configuration.races) {\n            for (let i = 0; i < racesToAdd.length; i++)\n                if (racesToAdd.race_id === race.race_id)\n                    continue;\n            racesToAdd.push(new Race(race.race_id, race.race_position, race.race_max_winners));\n        }\n        return racesToAdd;\n    }\n\n    const loadCandidates = (candidate_data) => {\n        for (let key in candidate_data) {\n            const race = find_race_by_name(key);\n            if (race === null)\n                continue;\n            for (const candidate of candidate_data[key]) {\n                let party = find_party_by_name(candidate.party);\n                if (party === null) {\n                    party = new Party(candidate.party, \"FFFFFF\");\n                    console.log(\"Adding Party: \", party.party_name);\n                    setParties([...parties, party]);\n                }\n                race.add_candidate(new Candidate(candidate.number, candidate.name, party));\n            }\n        }\n        setCandidatesLoaded(true);\n\n        return;\n    }\n\n    const loadVoters = (ballot_data) => {\n        let voters = []\n        for (const item of ballot_data.ballots) {\n            let voter = new Voter(uuid())\n            for (let key in item) {\n                let candidateOrder = []\n                for (let candidate_id of item[key]) {\n                    let candidate = find_candidate_by_id(key, candidate_id);\n                    candidateOrder.push(candidate);\n                };\n\n                const ballot = new Ballot(uuid(), candidateOrder);\n                const race = find_race_by_id(key);\n                if (race !== null) {\n                    race.add_ballot(ballot);\n                }\n                voter.add_ballot(key, ballot);\n            }\n            voters.push(voter);\n        }\n        return voters;\n    }\n\n\n    const [election_configuration, setElectionConfiguration] = useState([]);\n    const [candidate_data, setCandidateData] = useState([]);\n    const [party_data, setPartyData] = useState([]);\n    const [ballot_data, setBallotData] = useState([]);\n\n    const [isLoading, setIsLoading] = useState(true);\n\n    const [partiesLoaded, setPartiesLoaded] = useState(false);\n    const [racesLoaded, setRacesLoaded] = useState(false);\n    const [candidatesLoaded, setCandidatesLoaded] = useState(false);\n    const [votersLoaded, setVotersLoaded] = useState(false);\n\n    const [parties, setParties] = useState([]);\n    const [races, setRaces] = useState([]);\n    const [voters, setVoters] = useState([]);\n\n    const [activeRace, setActiveRace] = useState(null);\n    const [speed, setSpeed] = useState(1000);\n    const [refresh, setRefresh] = useState(false);\n    const [isRunning, setIsRunning] = useState(false);\n    const [page, setPage] = useState(0);\n\n    const [model, setModel] = useState(0);\n\n    useEffect(() => {\n        if (!isLoading)\n            setPartiesLoaded(true);\n    }, [parties]); // eslint-disable-line react-hooks/exhaustive-deps\n\n    useEffect(() => {\n        if (!isLoading) {\n            if (activeRace === null)\n                setActiveRace(races[0]);\n            setRacesLoaded(true);\n        }\n    }, [races]); // eslint-disable-line react-hooks/exhaustive-deps\n\n    useEffect(() => {\n        if (!isLoading)\n            setVotersLoaded(true);\n    }, [voters]);  // eslint-disable-line react-hooks/exhaustive-deps\n\n\n    useEffect(() => {\n        const loadData = async () => {\n            if (props.data !== undefined && props.data !== null) {\n                setElectionConfiguration(props.data.election_configuration);\n                setCandidateData(props.data.candidate_data);\n                setPartyData(props.data.parties_data);\n                setBallotData(props.data.ballot_data);\n                setIsLoading(false);\n                return;\n            }\n            let electionId = props.match.params.electionId;\n\n            if (typeof (electionId) === \"undefined\") {\n                electionId = \"uc_berkeley\";\n            }\n\n            let yearId = props.match.params.yearId;\n            if (typeof (yearId) === \"undefined\") {\n                yearId = \"2015\";\n            }\n\n            let databaseString = 'elections/' + electionId + \"/\" + yearId;\n\n            console.log(\"Loading Data From DataBase\");\n            await firebase.database().ref(databaseString).once('value', snapshot => {\n                if (!snapshot.exists()) {\n                    console.log(\"Path Doesn't Exist, Loading Default Reference\");\n                    databaseString = 'elections/uc_berkeley/2015';\n                }\n            });\n\n            firebase.database().ref(databaseString).once('value', snapshot => {\n                setElectionConfiguration(snapshot.child('election_configuration').val());\n                setCandidateData(snapshot.child('candidate_data').val());\n                setPartyData(snapshot.child('parties_data').val());\n                setBallotData(snapshot.child('ballot_data').val());\n                setIsLoading(false);\n            });\n        }\n\n        if (isLoading) {\n            loadData();\n            return;\n        }\n        if (!partiesLoaded) {\n            console.log(\"Loading Parties\")\n            let parties = loadParties(party_data);\n            setParties(parties);\n        }\n\n        if (partiesLoaded && !racesLoaded) {\n            console.log(\"Loading Races\");\n            setRaces(loadRaces(election_configuration));\n            return;\n        }\n\n        if (racesLoaded && !candidatesLoaded) {\n            console.log(\"Loading Candidates\");\n            loadCandidates(candidate_data);\n            return;\n        }\n\n        if (candidatesLoaded && !votersLoaded) {\n            console.log(\"Loading Voters\");\n            setVoters(loadVoters(ballot_data));\n        }\n        if (votersLoaded) {\n            console.log(\"Finished Loading\");\n        }\n\n    }, [isLoading, partiesLoaded, racesLoaded, candidatesLoaded, votersLoaded]);  // eslint-disable-line react-hooks/exhaustive-deps\n\n    useInterval(() => {\n        if (activeRace.state !== RoundState.COMPLETE && isRunning) {\n            for (let i = 0; i < Math.floor(speed / 10); i++) {\n                activeRace.run_race_step();\n            }\n            setRefresh(!refresh);\n        } else {\n            setIsRunning(false)\n        }\n    }, isRunning ? 100 : null)\n\n    const switchActiveRace = (race) => {\n        setIsRunning(false);\n        setActiveRace(race);\n    }\n\n    const finishRaces = () => {\n        for (const race of races) {\n            while (race.state !== RoundState.COMPLETE) {\n                race.run_race_step();\n            }\n        }\n        setRefresh(!refresh);\n    }\n\n\n    // Render Everything\n    if (isLoading || activeRace == null)\n        return <h1> Loading... </h1>\n\n    const pageButtonStyle = { borderRadius: 0, height: \"100%\", width: '50%' };\n    let pageButtons = (\n        <ButtonGroup size=\"lg\" style={{ width: \"100%\", height: \"50\", padding: 0, margin: 0 }}>\n            <Button onClick={() => setPage(0)} disabled={page === 0} variant=\"secondary\" size=\"lg\" style={pageButtonStyle}>\n                {'Election'}\n            </Button>\n            <Button onClick={() => setPage(1)} disabled={page === 1} variant=\"secondary\" size=\"lg\" style={pageButtonStyle}>\n                {'Charts'}\n            </Button>\n            <Button onClick={() => setPage(2)} disabled={page === 2} variant=\"secondary\" size=\"lg\" style={pageButtonStyle}>\n                {'Models'}\n            </Button>\n        </ButtonGroup>\n    );\n\n    let raceTitle = (\n        <div className=\"title-text\" style={{ width: '100%', backgroundColor: 'grey', margin: '1% 2.5% 1% 2.5%', borderRadius: '5px' }}>\n            <h1 style={{ font: '3.5rem/1 arial, sans-serif', color: 'white', textAlign: 'center', padding: '1%' }}> {activeRace.race_name} </h1>\n        </div>\n    );\n\n    if (page === 0) {\n\n        let dropdownItems = races.map((item, index) => (\n            <Dropdown.Item key={index} as=\"button\" onClick={() => switchActiveRace(item)} > {item.race_name}</Dropdown.Item >\n        ));\n\n        return (\n            <div className=\"text-center\" style={{ display: \"flex\", justifyContent: 'center', flexWrap: 'wrap' }}>\n                {pageButtons}\n                {raceTitle}\n                <div className=\"election-table\" style={{ width: '100%' }}>\n                    <CandidateList candidates={activeRace.candidateTable} refresh={refresh} />\n                </div>\n                <ButtonGroup size=\"lg\" style={{ borderRadius: '5px', width: '100%', margin: '0% 2.5% 0% 2.5%' }}>\n                    <DropdownButton id=\"dropdown-item-button\" as={ButtonGroup} title=\"Change Race\" variant=\"primary\" size=\"lg\" style={{ boxShadow: '0 0 0 1px black', borderRadius: '5px 0px 0px 5px' }}>\n                        {dropdownItems}\n                    </DropdownButton>\n                    <Button onClick={() => setIsRunning(true)} disabled={isRunning} variant=\"primary\" style={{ boxShadow: '0 0 0 1px black', width: '5%' }}>\n                        {'Run Election'}\n                    </Button>\n                    <Button onClick={finishRaces} disabled={false} variant=\"primary\" style={{ boxShadow: '0 0 0 1px black', width: '5%' }}>\n                        {'Finish Races'}\n                    </Button>\n                    <div style={{ boxShadow: '0 0 0 1px black', backgroundColor: '#007bff', width: '30%', borderRadius: '0px 5px 5px 0px' }}>\n                        <label style={{ font: '1.3rem/1 arial, sans-serif', color: 'white', textAlign: 'center', padding: '5% 0 0 0' }}>\n                            Speed\n                        </label>\n                        <div style={{ margin: '0% 5% 0% 5%' }}>\n                            <RangeSlider\n                                min={0}\n                                max={10000}\n                                step={10}\n                                value={speed}\n                                variant=\"secondary\"\n                                onChange={changeEvent => setSpeed(changeEvent.target.value)}\n                            />\n                        </div>\n                    </div>\n                </ButtonGroup>\n            </div >\n        );\n    } else if (page === 1) {\n        let chartStyle = {\n            alignSelf: 'center', width: '50%', height: '30vw',\n        }\n        return (\n            <div className=\"text-center\" style={{ display: \"flex\", justifyContent: 'center', flexWrap: 'wrap', width: '100%' }}>\n                {pageButtons}\n                {raceTitle}\n                <FirstChoicePie race={activeRace} parties={parties} style={chartStyle} />\n                <ElectedCandidatesPie race={activeRace} parties={parties} style={chartStyle} />\n                <CandidatesRanked race={activeRace} parties={parties} style={chartStyle} />\n                <PartyPercentage race={activeRace} parties={parties} style={chartStyle} />\n                <VoteOverTime race={activeRace} parties={parties} style={chartStyle} />\n                <VoteOverTimeBump race={activeRace} style={chartStyle} />\n                <EventualWinner race={activeRace} style={chartStyle} />\n                <RoundCandidateBump race={activeRace} style={chartStyle} />\n            </div >\n        );\n    } else {\n        let modelButtons = (\n            <ButtonGroup size=\"lg\" style={{ width: \"100%\", height: \"50\", padding: 0, margin: 0 }}>\n                <Button onClick={() => setModel(0)} disabled={model === 0} variant=\"secondary\" size=\"lg\" style={pageButtonStyle}>\n                    {'Bar'}\n                </Button>\n                <Button onClick={() => setModel(1)} disabled={model === 1} variant=\"secondary\" size=\"lg\" style={pageButtonStyle}>\n                    {'Sankey'}\n                </Button>\n            </ButtonGroup>\n        );\n        if (model === 0) {\n            return (\n                <div className=\"text-center\" style={{\n                    display: \"flex\",\n                    justifyContent: 'center',\n                    flexWrap: 'wrap'\n                }}>\n                    {pageButtons}\n                    {modelButtons}\n                    {raceTitle}\n                    <div style={{ display: \"flex\", flexWrap: 'wrap', justifyContent: 'center', alignItems: 'center', width: '100%' }}>\n                        <ElectionBar race={activeRace} style={{ alignSelf: 'center', width: '40vw' }} />\n                    </div>\n                </div>\n            );\n        }\n        else {\n            return (\n                <div className=\"text-center\" style={{\n                    height: '100%',\n                    minHeight: '100%',\n                    display: \"flex\",\n                    justifyContent: 'center',\n                    flexWrap: 'wrap'\n                }}>\n                    {pageButtons}\n                    {modelButtons}\n                    {raceTitle}\n                    <NivoSankey race={activeRace} style={{\n                        width: '90%',\n                        height: '60vw'\n                    }}\n                    />\n                </div >\n            );\n        }\n    }\n    // <SankeyGraph race={activeRace} width={\"1000\"} height={activeRace.candidates.length * 100} />\n}\n\nexport default ElectionPage;","import React, { Component } from 'react';\n\n\nexport class FourZeroFour extends Component {\n\n    render() {\n        return (\n            <div>\n                <h1>404: Oops! Page not found!</h1>\n            </div>)\n    }\n}\nexport default FourZeroFour;\n","import React, { useState } from 'react';\nimport firebase from 'firebase';\nimport Button from 'react-bootstrap/Button'\n\nimport { Form } from 'react-bootstrap';\n\nfunction AddToDatabase() {\n    const AddToDB = (event) => {\n        const checkStrings = (str) => {\n            return str === null || str.match(/^ *$/) !== null;\n        }\n        event.preventDefault();\n        let data = ({ election_configuration: election_configuration, candidate_data: candidate_data, ballot_data: ballot_data, parties_data: party_data });\n        if (!checkStrings(electionName) && !checkStrings(year)) {\n            firebase.database().ref(\"elections/\" + electionName + \"/\" + year).set(data);\n            alert(\"Added To Database: elections/\" + electionName + \"/\" + year);\n        }\n        else {\n            alert('Invalid Name');\n        }\n    }\n\n    const onChange = async (event, callback) => {\n        event.preventDefault()\n        const reader = new FileReader()\n        reader.onload = async (event) => {\n            callback(JSON.parse(event.target.result));\n        };\n        if (event.target.files[0] !== null)\n            reader.readAsText(event.target.files[0]);\n    }\n\n    const [electionName, setElectionName] = useState(\"\");\n    const [year, setYear] = useState(\"\");\n    const [election_configuration, setElectionConfiguration] = useState(null);\n    const [party_data, setPartyData] = useState(null);\n    const [candidate_data, setCandidateData] = useState(null);\n    const [ballot_data, setBallotData] = useState(null);\n\n    return (\n        <div className=\"text-center\">\n            <h1> Add to Database </h1>\n            <Form onSubmit={AddToDB}>\n                <Form.Group>\n                    <Form.Control type=\"text\" value={electionName} onChange={(event) => setElectionName(event.target.value)} placeholder=\"Election Name\" />\n                    <Form.Control type=\"text\" value={year} onChange={(event) => setYear(event.target.value)} placeholder=\"Year\" />\n                </Form.Group>\n                <Form.Group style={{ display: 'grid', justifyItems: 'center' }}>\n                    <Form.File onChange={(event) => onChange(event, setElectionConfiguration)} accept='.json' label=\"Election Configuration\" style={{ backgroundColor: 'grey', margin: '5px' }} />\n                    <Form.File onChange={(event) => onChange(event, setPartyData)} label=\"Party Data\" style={{ backgroundColor: 'grey', margin: '5px' }} />\n                    <Form.File onChange={(event) => onChange(event, setCandidateData)} label=\"Candidate Data\" style={{ backgroundColor: 'grey', margin: '5px' }} />\n                    <Form.File onChange={(event) => onChange(event, setBallotData)} label=\"Ballot Data\" style={{ backgroundColor: 'grey', margin: '5px' }} />\n                </Form.Group>\n                <Form.Group>\n                    <Button variant=\"primary\" type=\"submit\">\n                        Submit\n                    </Button>\n                </Form.Group>\n            </Form>\n        </div >\n    );\n}\n\nexport default AddToDatabase;\n","import React, { Fragment } from 'react';\nimport { BrowserRouter, Route, Switch } from 'react-router-dom';\nimport { Redirect, withRouter } from \"react-router\";\nimport './firebase';\nimport './App.css'\n\nimport NavBar from './Components/NavBar/NavBar';\nimport Home from './Components/Home';\nimport ElectionPage from './Components/ElectionPage/ElectionPage';\nimport FourZeroFour from './Components/FourZeroFour';\nimport AddToDatabase from './Components/AddToDatabase';\n\nimport election_configuration from './Data/Configuration.json';\nimport candidate_data from './Data/Candidates.json';\nimport parties_data from './Data/Parties.json';\nimport ballot_data from './Data/Ballots.json';\n\nconst NavBarWithRouter = withRouter(NavBar);\n\nfunction App() {\n    return (\n        <BrowserRouter basename='/stvote' style={{ width: '100%', height: '100%' }}>\n            <Fragment >\n                <NavBarWithRouter style={{ width: '100%', height: '100%' }} />\n                <main style={{ width: '100%', height: '100%' }}>\n                    <Switch>\n                        <Route exact path='/'> <Redirect to=\"/home\" /> </Route>\n                        <Route path='/home' component={Home} />\n                        <Route exact path='/election' render={() => (<ElectionPage data={{ election_configuration: election_configuration, candidate_data: candidate_data, parties_data: parties_data, ballot_data: ballot_data }} />)} />\n                        <Route exact path='/election/:electionId' component={ElectionPage} />\n                        <Route path='/election/:electionId/:yearId' component={ElectionPage} />\n                        <Route path='/add' component={AddToDatabase} />\n                        <Route component={FourZeroFour} />\n                    </Switch>\n                </main>\n            </Fragment>\n        </BrowserRouter>\n    );\n}\n\nexport default App;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import 'bootstrap/dist/css/bootstrap.css';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App style={{ width: '100%', height: '100%' }} />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}